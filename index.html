<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word to Video & Audio</title>
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=dcCOiyQD"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Content Generator</h1>
        <p>Generate stunning videos and audio from your words</p>
    </header>

    <main>
        <section class="input-section">
            <input type="text" id="userInput" class="input-box" placeholder="Enter a word or phrase">
            <button onclick="generateContent()" class="generate-button">Generate</button>
        </section>

        <section class="output-section">
            <p id="status">Waiting for input...</p>
            <div id="preview" class="video-preview"></div>
        </section>
    </main>

    <footer>
        <p>Powered by ResponsiveVoice, Pexels, and Jamendo APIs</p>
    </footer>

    <script>
        const PEXELS_API_KEY = 'fgAGITIuPfxSnDjrRWN5Dwd6xKvYGSrP9MdPFFIYXzEmGl2DruIsTiVm'; // Replace with your Pexels API key
        const JAMENDO_CLIENT_ID = '1398578b'; // Replace with your Jamendo client ID

        async function generateContent() {
            const word = document.getElementById('userInput').value;
            if (!word) {
                alert("Please enter a word or phrase!");
                return;
            }

            document.getElementById('status').textContent = "Generating content...";

            try {
                const narrationPath = await fetchNarration(word);
                const videoUrl = await fetchPexelsVideo(word);
                const musicUrl = await fetchJamendoMusic(word);

                document.getElementById('status').textContent = "Content generated successfully!";
                document.getElementById('preview').innerHTML = "";

                const videoElement = document.createElement('video');
                videoElement.src = videoUrl;
                videoElement.controls = true;
                videoElement.style.width = '100%';
                document.getElementById('preview').appendChild(videoElement);

                const narrationAudio = new Audio(narrationPath);
                narrationAudio.controls = true;
                document.getElementById('preview').appendChild(narrationAudio);

                const musicAudio = new Audio(musicUrl);
                musicAudio.controls = true;
                musicAudio.volume = 0.2;
                document.getElementById('preview').appendChild(musicAudio);

                videoElement.onplay = () => {
                    narrationAudio.play();
                    musicAudio.play();
                };

                videoElement.onpause = () => {
                    narrationAudio.pause();
                    musicAudio.pause();
                };

                videoElement.onended = () => {
                    narrationAudio.pause();
                    musicAudio.pause();
                };

            } catch (error) {
                console.error("Error generating content:", error);
                document.getElementById('status').textContent = "An error occurred. Please try again.";
            }
        }

        async function fetchNarration(text) {
            return new Promise((resolve) => {
                responsiveVoice.speak(text, "US English Female", {
                    onend: () => resolve(`/tmp/${text}.mp3`) // Replace with actual path
                });
            });
        }

        async function fetchPexelsVideo(query) {
            const response = await fetch(`https://api.pexels.com/videos/search?query=${query}&per_page=1`, {
                headers: { Authorization: PEXELS_API_KEY }
            });
            const data = await response.json();
            return data.videos[0].video_files[0].link;
        }

        async function fetchJamendoMusic(query) {
            const response = await fetch(`https://api.jamendo.com/v3.0/tracks/?client_id=${JAMENDO_CLIENT_ID}&search=${query}&limit=1`);
            const data = await response.json();
            return data.results[0]?.audio || "";
        }
    </script>
</body>
</html>
